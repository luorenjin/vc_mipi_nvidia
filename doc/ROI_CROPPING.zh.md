中文版基于[原英文文档](ROI_CROPPING.md) v 0.19.0 翻译

# ROI 裁剪

根据相机的使用方式，有不同的 ROI 裁剪使用方法。在使用带有 `nvarguscamerasrc` 的 GStreamer 时，您需要通过在设备树文件中定义来设置 ROI。另一方面，如果您通过 V4L 使用相机模块，则可以通过相应的 V4L 命令在运行时定义 ROI。

下表显示了相机可以调整的范围。

>**注意**：如果一列中有两个值。第一个值用于 RAW08，第二个值用于 RAW10/RAW12 像素格式。

| <br>相机 | 版本 | 宽度<br>最小值 | <br>最大值 | <br>步进 | 高度<br>最小值 | <br>最大值 | <br>步进 | 帧率<br>提升 |
| ------ | --- | --------- | --------- | --------- | ---------- | ---------- | ---------- | ---- |
| IMX178 |  01 |  88 / 100 |      3072 |    8 / 16 |         32 |       2048 |          1 |  是 |
| IMX183 |  12 |      5440 |      5440 |         - |         32 |       3648 |          1 |  是 |
| IMX226 |  13 |   56 / 40 |      3904 |    4 / 20 |         32 |       3000 |          1 |  是 |
| IMX250 |  07 |       176 |      2432 |    8 / 16 |         32 |       2048 |          4 |  是 |
| IMX252 |  10 |       176 |      2048 |    8 / 16 |         32 |       1536 |          4 |  是 |
| IMX264 |  03 |        96 |      2432 |        16 |        128 |       2048 |          4 |  是 |
| IMX265 |  01 |        96 |      2048 |        16 |         32 |       1536 |          4 |  是 |
| IMX273 |  13 | 160 / 176 |      1440 |    8 / 16 |         32 |       1080 |          4 |  是 |
| IMX290 |  02 |       160 |      1920 |        32 |         32 |       1080 |          1 |  是 |
| IMX296 |  42 |         4 |      1440 |         4 |         32 |       1080 |          1 |  是 |
| IMX297 |  ?? |         4 |       720 |         4 |         32 |        540 |          1 |  是 |
| IMX327 |  02 |       160 |      1920 |        32 |         32 |       1080 |          1 |  是 |
| IMX335 |  00 |       104 |      2592 |         4 |         32 |       1944 |          1 |  是 |
| IMX392 |  06 | 160 / 176 |      1920 |    8 / 16 |         32 |       1200 |          4 |  是 |
| IMX412 |  02 |         4 |      4032 |         4 |         32 |       3040 |          1 |  是 |
| IMX415 |  01 |         4 |      3840 |         4 |         32 |       2160 |          1 |  是 |
| IMX462 |  01 |       160 |      1920 |        32 |         32 |       1080 |          1 |  是 |
| IMX565 |  01 |       608 |      4128 |        32 |         32 |       3000 |          8 |  是 |
| IMX566 |  02 |       608 |      2848 |        32 |         32 |       2848 |          8 |  是 |
| IMX567 |  02 |       608 |      2464 |        32 |         32 |       2064 |          8 |  是 |
| IMX568 |  03 |       608 |      2464 |        32 |         32 |       2064 |          8 |  是 |
| OV7281 |  01 |       156 |       640 |         4 |         32 |        480 |          1 |   否 |
| OV9281 |  02 |        32 |      1280 |         4 |         32 |        800 |          1 |   否 |

## 配合 nvarguscamerasrc 使用 GStreamer

如果您正在使用带有 `nvarguscamerasrc` 的 GStreamer，您需要通过在设备树文件的 `mode0` 节点中进行定义来设置 ROI。这是必要的，因为 `nvarguscamerasrc` 需要 `active_w` 和 `active_h` 来配置 ISP 管道。

在 `mode0` 节点中定义 ROI：
```
        ...
        mode0 {
                ...
                active_l = "360";       // 左
                active_t = "270";       // 上
                active_w = "720";       // 宽度
                active_h = "540";       // 高度
                ...
        };
```

## V4L

如果您想通过 V4L 使用相机，可以在运行时更改 ROI。

> **注意**：您可以将 `mode0` 的 `active_l`、`active_t`、`active_w` 和 `active_h` 值保持为零。您不必在设备树文件中设置任何值。

> **注意**：在使用带有 `nvarguscamerasrc` 的 GStreamer 时，请勿通过以下命令在运行时更改 ROI。否则管道将无法正常工作。

在命令行中，您可以通过以下方式更改 ROI：
```
$ v4l2-ctl --set-fmt-video=width=720,height=540
```
如果您还想设置 ROI 裁剪位置，请使用：
```
$ v4l2-ctl --set-selection=left=360,top=270,width=720,height=540
```
